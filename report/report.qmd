---
title: "RCT project"
subtitle: "Client name"
author: "Alexandre Bohyn"
format: 
  html:
    toc: true
    toc-location: left
    number-sections: true
    self-contained: true
    theme: inst/styles.scss
  pdf:
    toc: true
    toc-depth: 2
    number-sections: true
    documentclass: article
    classoption: landscape
    fontsize: 12pt
    geometry: margin=1in
    include-in-header: inst/header.tex
  docx:
    toc: true
    toc-depth: 2
    number-sections: true
execute:
  echo: false
---

\pagebreak

```{r load-packages}
#| warning: false

library(gtsummary)
library(ggplot2)
library(here)
```

```{r load-data}
trial <- readRDS(here("data/processed/trial.rds"))
```

\pagebreak

# Descriptive statistics

```{r tbl-iris-summary}
#| tbl-cap: "Descriptive statistics of the TRIAL dataset."
#| tbl-pos: "H"

trial |>
  tbl_summary(
    by = trt,
    type = all_continuous() ~ "continuous2",
    statistic = all_continuous2() ~
      c("{mean} ({sd})", "{median} ({p25}, {p75})"),
    digits = all_continuous2() ~ 1
  ) |>
  add_overall() |>
  add_p() |>
  as_flex_table()
```

\pagebreak

# Survival analysis

```{r fig-km}
#| fig-cap: "Kaplan-Meier curve per treatment group."
#| out-width: "90%"

knitr::include_graphics(path = here::here("output/figures/km_trt.png"))
```

```{r tbl-coxph}
#| tbl-cap: "Cox proportional hazards model results."
#| tbl-pos: "H"

tab <- readRDS(here("data/tables/coxph_hr.rds"))
tab |>
  as_flex_table()
```